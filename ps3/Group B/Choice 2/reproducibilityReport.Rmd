---
title: "Reproducibility Report: Group B Choice 2"
author: "David Barnstone & Julia Proshan"
output:
  html_document:
    toc: true
    toc_float: true
---

-------

> *AI disclosure: We used ChatGPT and Claude to check our work.*

For this exercise, please try to reproduce the results from Experiment 1 of the associated paper (Ko, Sadler & Galinsky, 2015). The PDF of the paper is included in the same folder as this Rmd file. 

#### Methods summary: 

A sense of power has often been tied to how we perceive each other's voice. Social hierarchy is embedded into the structure of society and provides a metric by which others relate to one another. In 1956, the Brunswik Lens Model was introduced to examine how vocal cues might influence hierarchy. In "The Sound of Power: Conveying and Detecting Hierarchical Rank Through Voice," Ko and colleagues investigated how manipulation of hierarchal rank within a situation might impact vocal acoustic cues. Using the Brunswik Model, six acoustic metrics were utilized (pitch mean & variability, loudness mean & variability, and resonance mean & variability) to isolate a potential contribution between individuals of different hierarchal rank. In the first experiment, Ko, Sadler & Galinsky examined the vocal acoustic cues of individuals before and after being assigned a hierarchal rank in a sample of 161 subjects (80 male). Each of the six hierarchy acoustic cues were analyzed with a 2 (high vs. low rank condition) x 2 (male vs. female) analysis of covariance, controlling for the baseline of the respective acoustic cue.

------

#### Target outcomes: 

Below is the specific result you will attempt to reproduce (quoted directly from the results section of Experiment 1):

> The impact of hierarchical rank on speakers’ acoustic cues. Each of the six hierarchy-based (i.e., postmanipulation) acoustic variables was submitted to a 2 (condition: high rank, low rank) × 2 (speaker’s sex: female, male) between-subjects analysis of covariance, controlling for the corresponding baseline acoustic variable. Table 4 presents the adjusted means by condition. Condition had a significant effect on pitch, pitch variability, and loudness variability. Speakers’ voices in the high-rank condition had higher pitch, **F(1, 156) = 4.48, p < .05**; were more variable in loudness, **F(1, 156) = 4.66, p < .05**; and were more monotone (i.e., less variable in pitch), **F(1, 156) = 4.73, p < .05**, compared with speakers’ voices in the low-rank condition (**all other Fs < 1**; see the Supplemental Material for additional analyses of covariance involving pitch and loudness). (from Ko et al., 2015, p. 6; emphasis added)

The adjusted means for these analyses are reported in Table 4 (Table4_AdjustedMeans.png, included in the same folder as this Rmd file).

------

```{r global_options, include=FALSE}
knitr::opts_chunk$set(echo=TRUE, warning=FALSE, message=FALSE)
```

## Step 1: Load packages

```{r}
library(tidyverse)   # for data munging
library(knitr)       # for kable table formating
library(haven)       # import and export 'SPSS', 'Stata' and 'SAS' Files
library(readxl)      # import excel files

# #optional packages:
# library(psych)
library(car)         # for ANCOVA
# library(compute.es) # for ANCOVA
library(lsmeans)     # for ANCOVA
library(effectsize)  # for calculating effect sizes
```

## Step 2: Load data

```{r}
# Just Experiment 1
d <-read_csv("data/S1_voice_level_Final.csv")
# DT::datatable(d)
```

## Step 3: Tidy data

```{r}
d = d %>%
  mutate(plev = factor(plev,
                       levels = c(-1,1),
                       labels = c("low", "high"))) %>%
  rename("rank" = plev) %>% 
  mutate(sex = as.factor(sex))
```

## Step 4: Run analysis

### Pre-processing

```{r}
# build models

## pitch
model_pitch_mean <- lm(formula = pitch_smean ~ 1 + rank + sex +
                         pitch_rmean, data = d)

## pitch variability
model_pitch_var <- lm(formula = pitch_svar ~ 1 + rank + sex +
                        pitch_rvar, data = d)

## loudness
model_loud_mean <- lm(formula = intense_smean ~ 1 + rank + sex +
                        intense_rmean, data = d)

## loudness variability
model_loud_var <- lm(formula = intense_svar ~ 1 + rank + sex +
                       intense_rvar, data = d)

## resonance
model_resonance_mean <- lm(formula = form_smean ~ 1 + rank + sex +
                             form_rmean, data = d)

## resonance variability
model_resonance_var <- lm(formula =form_svar ~ 1 + rank + sex +
                            form_rvar, data = d)
```

### Descriptive statistics

In the paper, the adjusted means by condition are reported (see Table 4, or Table4_AdjustedMeans.png, included in the same folder as this Rmd file). Reproduce these values below:

```{r}
# calculate adjusted means and effect sizes

## pitch
emmeans(model_pitch_mean, ~ rank)
eta_squared(model_pitch_mean, partial = TRUE)

## pitch variability
emmeans(model_pitch_var, ~ rank)
eta_squared(model_pitch_var, partial = TRUE)

## loudness
emmeans(model_loud_mean, ~ rank)
eta_squared(model_loud_mean, partial = TRUE)

## loudness variability
emmeans(model_loud_var, ~ rank)
eta_squared(model_loud_var, partial = TRUE)

## resonance
emmeans(model_resonance_mean, ~ rank)
eta_squared(model_resonance_mean, partial = TRUE)

## resonance variability
emmeans(model_resonance_var, ~ rank)
eta_squared(model_resonance_var, partial = TRUE)
```

### Inferential statistics

> The impact of hierarchical rank on speakers’ acoustic cues. Each of the six hierarchy-based (i.e., postmanipulation) acoustic variables was submitted to a 2 (condition: high rank, low rank) × 2 (speaker’s sex: female, male) between-subjects analysis of covariance, controlling for the corresponding baseline acoustic variable. [...] Condition had a significant effect on pitch, pitch variability, and loudness variability. Speakers’ voices in the high-rank condition had higher pitch, **F(1, 156) = 4.48, p < .05**; were more variable in loudness, **F(1, 156) = 4.66, p < .05**; and were more monotone (i.e., less variable in pitch), **F(1, 156) = 4.73, p < .05**, compared with speakers’ voices in the low-rank condition (**all other Fs < 1**; see the Supplemental Material for additional analyses of covariance involving pitch and loudness).

```{r}
# reproduce the above results here
Anova(model_pitch_mean, type = 3)
Anova(model_pitch_var, type = 3)
Anova(model_loud_mean, type = 3)
Anova(model_loud_var, type = 3)
Anova(model_resonance_mean, type = 3)
Anova(model_resonance_var, type = 3)
```

# Step 5: Reflection

Were you able to reproduce the results you attempted to reproduce? If not, what part(s) were you unable to reproduce?

> We were able to reproduce the reported means for all six acoustic cues. Our effect sizes differed slightly from those reported in the original paper, with those for pitch, pitch variability, loudness, and loudness variability being slightly larger in our reproduction. Our reproduced F and significance values were consistent, although did not match exactly, with the original paper.

How difficult was it to reproduce your results? 

> It was moderatley difficult to reproduce these results.

What aspects made it difficult? What aspects made it easy?

> The inclusion of a data dictionary was helpful in understanding the variables, although the naming conventions were confusing. It was also challenging to know exactly how they conducted their analyses (e.g. what software packages did they use?), which may explain the slight differences in some of our statistical outputs.